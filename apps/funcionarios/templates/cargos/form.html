{% extends "base.html" %}
{% load i18n %}

{% block title %}
{% if object %}{% trans "Editar Cargo" %}{% else %}{% trans "Novo Cargo" %}{% endif %}
{% endblock title %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <div class="mb-8">
        <h1 class="text-2xl font-bold text-gray-800">
            {% if object %}{% trans "Editar Cargo" %}{% else %}{% trans "Novo Cargo" %}{% endif %}
        </h1>
        <p class="text-gray-500">{% trans "Defina as informações básicas, remuneração e permissões do cargo." %}</p>
    </div>

    <div class="bg-white shadow-xl rounded-lg p-6 border border-gray-100">
        <form method="post" class="space-y-8">
            {% csrf_token %}

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <div class="space-y-6">
                    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4">{% trans "Informações Base" %}</h2>
                    
                    <div class="field-group">
                        <label for="{{ form.nome.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Nome do Cargo" %}</label>
                        {{ form.nome }}
                        {% if form.nome.errors %}<p class="text-red-500 text-xs mt-1">{{ form.nome.errors }}</p>{% endif %}
                    </div>

                    <div class="field-group">
                        <label for="{{ form.codigo.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Código Único" %}</label>
                        {{ form.codigo }}
                        {% if form.codigo.errors %}<p class="text-red-500 text-xs mt-1">{{ form.codigo.errors }}</p>{% endif %}
                    </div>
                    
                    <div class="field-group">
                        <label for="{{ form.categoria.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Categoria" %}</label>
                        {{ form.categoria }}
                    </div>
                    
                    <div class="field-group">
                        <label for="{{ form.nivel_hierarquico.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Nível Hierárquico" %}</label>
                        {{ form.nivel_hierarquico }}
                    </div>
                    
                    <div class="field-group">
                        <label for="{{ form.cargo_superior.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Cargo Superior (Reporta a)" %}</label>
                        {{ form.cargo_superior }}
                    </div>

                    <div class="field-group">
                        <label for="{{ form.descricao.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Descrição" %}</label>
                        {{ form.descricao }}
                    </div>
                    
                    <div class="flex items-center pt-4 border-t border-gray-100">
                        {{ form.ativo }}
                        <label for="{{ form.ativo.id_for_label }}" class="ml-2 block text-sm font-medium text-gray-900">
                            {% trans "Cargo Ativo" %}
                        </label>
                    </div>

                </div>

                <div class="space-y-6">
                    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4">{% trans "Remuneração e Limites" %}</h2>

                    <div class="field-group">
                        <label for="{{ form.salario_base.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Salário Base (Kz)" %}</label>
                        {{ form.salario_base }}
                    </div>

                    <div class="field-group">
                        <label for="{{ form.vale_alimentacao.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Vale Alimentação (Kz)" %}</label>
                        {{ form.vale_alimentacao }}
                    </div>

                    <div class="field-group">
                        <label for="{{ form.vale_transporte.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Vale Transporte (Kz)" %}</label>
                        {{ form.vale_transporte }}
                    </div>
                    
                    <div class="field-group">
                        <label for="{{ form.limite_desconto_percentual.id_for_label }}" class="block text-sm font-medium text-gray-700">{% trans "Limite Desc. (%)" %}</label>
                        {{ form.limite_desconto_percentual }}
                    </div>
                    
                    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4 pt-4">{% trans "Permissões de Vendas" %}</h2>
                    
                    <div class="space-y-2">
                        <div class="flex items-center">{{ form.pode_vender }}<label for="{{ form.pode_vender.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Vender" %}</label></div>
                        <div class="flex items-center">{{ form.pode_fazer_desconto }}<label for="{{ form.pode_fazer_desconto.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Fazer Desconto" %}</label></div>
                        <div class="flex items-center">{{ form.pode_cancelar_venda }}<label for="{{ form.pode_cancelar_venda.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Cancelar Venda" %}</label></div>
                        <div class="flex items-center">{{ form.pode_fazer_devolucao }}<label for="{{ form.pode_fazer_devolucao.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Fazer Devolução" %}</label></div>
                        <div class="flex items-center">{{ form.pode_alterar_preco }}<label for="{{ form.pode_alterar_preco.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Alterar Preço" %}</label></div>
                    </div>
                    
                    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4 pt-4">{% trans "Permissões de Estoque/Compras" %}</h2>
                    
                    <div class="space-y-2">
                        <div class="flex items-center">{{ form.pode_gerenciar_estoque }}<label for="{{ form.pode_gerenciar_estoque.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Gerenciar Estoque" %}</label></div>
                        <div class="flex items-center">{{ form.pode_fazer_compras }}<label for="{{ form.pode_fazer_compras.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Fazer Compras" %}</label></div>
                        <div class="flex items-center">{{ form.pode_aprovar_pedidos }}<label for="{{ form.pode_aprovar_pedidos.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Aprovar Pedidos" %}</label></div>
                        <div class="flex items-center">{{ form.pode_editar_produtos }}<label for="{{ form.pode_editar_produtos.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Editar Produtos" %}</label></div>
                    </div>

                </div>

                <div class="space-y-6">
    
    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4">{% trans "Permissões de RH/Pessoas" %}</h2>
    <div class="space-y-2">
         <div class="flex items-center">{{ form.pode_gerenciar_funcionarios }}<label for="{{ form.pode_gerenciar_funcionarios.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Gerenciar Funcionários" %}</label></div>
         <div class="flex items-center">{{ form.pode_pagar_salario }}<label for="{{ form.pode_pagar_salario.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Pagar Salário" %}</label></div>
    </div>
    
    <h2 class="text-xl font-bold text-indigo-700 border-b pb-2 mb-4 pt-4">{% trans "Permissões de Faturamento" %}</h2>
    <div class="space-y-2">
        <div class="flex items-center">{{ form.pode_emitir_faturacredito }}<label for="{{ form.pode_emitir_faturacredito.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Emitir Fatura-Crédito" %}</label></div>
        <div class="flex items-center">{{ form.pode_liquidar_faturacredito }}<label for="{{ form.pode_liquidar_faturacredito.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Liquidar Fatura-Crédito" %}</label></div>
        <div class="flex items-center">{{ form.pode_emitir_proforma }}<label for="{{ form.pode_emitir_proforma.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Emitir Proforma" %}</label></div>
        <div class="flex items-center">{{ form.pode_aprovar_proforma }}<label for="{{ form.pode_aprovar_proforma.id_for_label }}" class="ml-2 block text-sm text-gray-700">{% trans "Pode Aprovar Proforma" %}</label></div>
    </div>
</div>
            </div>

            <div class="flex justify-end gap-3 pt-6 border-t border-gray-200">
                <a href="{% url 'funcionarios:cargo_lista' %}" 
                    class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">
                    Cancelar
                </a>
                <button type="submit" 
                        class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    Salvar Cargo
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock content %}

{% block extra_js %}
<script>
    // Apenas a estilização Tailwind CSS para manter a aparência profissional
    document.addEventListener('DOMContentLoaded', function() {
        // Estiliza os campos de texto, números e selects (não-checkboxes)
        const inputs = document.querySelectorAll('.field-group input:not([type="checkbox"]), .field-group select, .field-group textarea');
        inputs.forEach(input => {
            if (input.classList.contains('form-control')) {
                input.classList.add('mt-1', 'block', 'w-full', 'rounded-md', 'border-gray-300', 'shadow-sm', 'focus:border-indigo-500', 'focus:ring-indigo-500', 'sm:text-sm', 'p-2.5');
                input.classList.remove('form-control');
            }
        });

        // Estiliza os checkboxes com classes Tailwind
        const checkboxes = document.querySelectorAll('.form-checkbox');
        checkboxes.forEach(checkbox => {
            // Assegura que o estilo seja aplicado aos checkboxes
            checkbox.classList.add('h-4', 'w-4', 'text-indigo-600', 'border-gray-300', 'rounded', 'focus:ring-indigo-500');
        });
    });
</script>
{% endblock extra_js %}